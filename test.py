import json

# Danh sách ký tự giữ lại (bao gồm các dấu thanh của tiếng Việt)
chars_to_keep = [
    # Chữ số
    '0', '1', '2', '3', '4', '5', '6', '7', '8', '9',

    # Chữ thường a-z
    'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm',
    'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z',

    # Chữ hoa A-Z
    'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M',
    'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z',

    # Chữ tiếng Việt thường
    'à', 'á', 'â', 'ã', 'è', 'é', 'ê', 'ì', 'í', 'ò', 'ó', 'ô', 'õ',
    'ù', 'ú', 'ý', 'ă', 'đ', 'ĩ', 'ũ', 'ơ', 'ư', 'ạ', 'ả', 'ấ', 'ầ',
    'ẩ', 'ẫ', 'ậ', 'ắ', 'ằ', 'ẳ', 'ẵ', 'ặ', 'ẹ', 'ẻ', 'ẽ', 'ế', 'ề',
    'ể', 'ễ', 'ệ', 'ỉ', 'ị', 'ọ', 'ỏ', 'ố', 'ồ', 'ổ', 'ỗ', 'ộ', 'ớ',
    'ờ', 'ở', 'ỡ', 'ợ', 'ụ', 'ủ', 'ứ', 'ừ', 'ử', 'ữ', 'ự', 'ỳ', 'ỵ',
    'ỷ', 'ỹ',

    # Chữ tiếng Việt hoa
    'À', 'Á', 'Â', 'Ã', 'È', 'É', 'Ê', 'Ì', 'Í', 'Ò', 'Ó', 'Ô', 'Õ',
    'Ù', 'Ú', 'Ý', 'Ă', 'D', 'Ĩ', 'Ũ', 'Ơ', 'Ư', 'Ạ', 'Ả', 'Ấ', 'Ầ',
    'Ẩ', 'Ẫ', 'Ậ', 'Ắ', 'Ằ', 'Ẳ', 'Ẵ', 'Ặ', 'Ẹ', 'Ẻ', 'Ẽ', 'Ế', 'Ề',
    'Ể', 'Ễ', 'Ệ', 'Ỉ', 'Ị', 'Ọ', 'Ỏ', 'Ố', 'Ồ', 'Ổ', 'Ỗ', 'Ộ', 'Ớ',
    'Ờ', 'Ở', 'Ỡ', 'Ợ', 'Ụ', 'Ủ', 'Ứ', 'Ừ Ư', 'Ự', 'Ỳ', 'Ỵ', 'Ỷ', 'Ỹ',

    # Dấu câu cơ bản
    ' ', '.', ',', ':', ';', '!', '?', '(', ')', '-', '_', '"', "'",

    # Ký tự đặc biệt
    '@', '#', '$', '%', '&', '*', '+', '=', '/', '<', '>', '^', '|', '{', '}', '[', ']', '~', '`', '\\', '¥', '€', '£',

    # Ký tự toán học
    '∞', '≤', '≥', '≠', '÷', '×', '±', '∑', '√', '∫', '∂',

    # Ký tự tiếng Việt khác
    '…', '«', '»', '§', '©', '®', '™', '–', '—',

    # Ký tự Latin mở rộng (không trùng với tiếng Việt)
    'ä', 'å', 'æ', 'ç', 'ë', 'ï', 'ñ', 'ö', 'ø', 'ß', 'ü', 'ÿ',
    'Ä', 'Å', 'Æ', 'Ç', 'Ë', 'Ï', 'Ñ', 'Ö', 'Ø', 'Ü', 'Ÿ',
    'ā', 'ą', 'ć', 'č', 'ď', 'ē', 'ę', 'ě', 'ğ', 'ģ', 'ħ', 'ī', 'į', 'ı',
    'ķ', 'ĺ', 'ļ', 'ł', 'ń', 'ņ', 'ň', 'ō', 'ő', 'œ', 'ŕ', 'ř', 'ś', 'ş',
    'š', 'ť', 'ū', 'ŭ', 'ů', 'ű', 'ų', 'ź', 'ż', 'ž',
    'Ā', 'Ą', 'Ć', 'Č', 'Ď', 'Ē', 'Ę', 'Ě', 'Ğ', 'Ģ', 'Ħ', 'Ī', 'Į', 'İ',
    'Ķ', 'Ĺ', 'Ļ', 'Ł', 'Ń', 'Ņ', 'Ň', 'Ō', 'Ő', 'Œ', 'Ŕ', 'Ř', 'Ś', 'Ş',
    'Š', 'Ť', 'Ū', 'Ŭ', 'Ů', 'Ű', 'Ų', 'Ź', 'Ż', 'Ž'
]


# Tạo char_to_idx mới
new_char_to_idx = {char: str(idx + 1) for idx, char in enumerate(chars_to_keep)}

# Lưu vào file mới
with open("D:/Vietnamese-handwritten/data/char_to_idx_simplified.json", 'w', encoding='utf-8') as f:
    json.dump(new_char_to_idx, f, ensure_ascii=False, indent=4)

print(f"Số ký tự mới: {len(new_char_to_idx)}")
print(f"Số lớp đầu ra (num_classes): {len(new_char_to_idx) + 1}")
